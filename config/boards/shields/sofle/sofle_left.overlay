#include "sofle.dtsi"

/ {
    chosen {
        /* Indica a ZMK cuál es el dispositivo de LEDs underglow */
        zmk,underglow = &ws2812_ug;
        /* Asocia la matriz de escaneo de teclas */
        zmk,kscan = &kscan0;
    };

    /* Definición del dispositivo SPI de los LEDs SK6812/WS2812 */
    ws2812_ug: ws2812_ug@0 {
        compatible = "worldsemi,ws2812-spi";
        label = "WS2812_UG";

        /* ⚠️ Pin de datos. Mikoto 7.2 suele usar P0.06 o P1.08 */
        data-gpios = <&gpio0 6 GPIO_ACTIVE_HIGH>;

        /* Frecuencia SPI segura para SK6812 */
        spi-max-frequency = <4000000>;

        /* Mapeo de color estándar RGB */
        color-mapping = <LED_COLOR_MAPPING_RGB>;

        /* Longitud de la tira del Sofle RGB (2x36 = 72) */
        chain-length = <72>;

        status = "okay";
    };
};

/* Desplazamiento de columnas (izquierda) */
&default_transform {
    col-offset = <6>;
};

/* Pines de columnas para Sofle */
&kscan0 {
    col-gpios =
        <&pro_micro 10 GPIO_ACTIVE_HIGH>,
        <&pro_micro 16 GPIO_ACTIVE_HIGH>,
        <&pro_micro 14 GPIO_ACTIVE_HIGH>,
        <&pro_micro 15 GPIO_ACTIVE_HIGH>,
        <&pro_micro 18 GPIO_ACTIVE_HIGH>,
        <&pro_micro 19 GPIO_ACTIVE_HIGH>;
};

/* Habilitar encoder derecho */
&right_encoder {
    status = "okay";
};
